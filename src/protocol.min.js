define(["transducers"],function(p){function d(){}var g=[],k=[];d.call=function(a,d){function f(){c.i=g.length;g.push(e);k.push(c)}function l(a,c){var b=a[c];"object"==typeof b?Object.keys(b).some(function(a,c){h.push(a);l(b,a);h.pop()}):Array.isArray(b)?b.some(function(a,c){h.push(a);l(b,c);h.pop()}):b.t===p.sig&&(++m,b.then(function(b){a[c]=b;--m||f()})||(n=n||void 0==b.i,(e.d=e.d||{}).push([h.join("."),b.i]),a[c]=void 0))}var c=p.sig(!0),e={b:d},h=[],m=1,n;l(e,0);n?(e.d=void 0,--m||f()):f();return c};
d.flush=function(){if(g.length){var a=new XMLHttpRequest,d=g,f=k;g=[];k=[];a.onreadystatechange=function(){if(3<a.readyState)if(a.getAllResponseHeaders(),2==(""+a.status)[0]){var d=JSON.stringify(a.responseText);f.some(function(a,e){return a(d[e],!0)})}else f.some(function(a){return a(void 0,!0)});else 1<a.readyState&&a.getAllResponseHeaders()};a.open("GET",void 0,!0);a.send(JSON.stringify(d))}};return d});
