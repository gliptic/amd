define(function(){function n(a){return a}function k(a,b){return function(c,d){return a(b(c,d))}}function w(a,b){return a.some(function(a){return b(a)})}function h(a,b){return Object.keys(a).some(function(c){return b([c,a[c]])})}function l(a,b){Array.isArray(a)?b[a[0]]=a[1]:h(a,function(a){return l(a,b)})}function p(a,b){q(a,b);return b.b&&b.b()}function q(a,b){var c=!1;if(Array.isArray(a))c=w(a,b);else if(a.then)c=a.then(b);else{var d;d=(d=a[x])?d.call(a):void 0;var f;if(d)for(;f=d.next(),!c&&!f.done;)c=
b(f.value);else c=h(a,b)}return c}function e(a,b){a.b&&(b.b=a.b);a.d&&(b.d=a.d);return b}function r(a){return function(b){return e(b,function(c){return b(a(c))})}}function t(){return function(a){return e(a,function(b){return q(b,a)})}}function u(a){var b=[],c=[],d=!1,f=function(e,g){a&&(c=c.concat(e));d=g;b=b.filter(function(b){return b(e)});return!b.length||!f.then};f.then=function(a){a.d&&a.d(1);var f=function(b){return b.some(a)||d?(a.d&&a.d(-1),!1):!0};f(c)&&b.push(f)};return f}var m=function(a,
b){b=b||[];return e({b:function(){return b}},function(a){b.push(a)})},y=function(a,b){b=b||{};return e({b:function(){return b}},function(a){return l(a,b)})},x=Symbol?Symbol.iterator:"@@iterator",g=n,v={map:r,filter:function(a){return function(b){return e(b,function(c){return a(c)&&b(c)})}},take:function(a){return function(b){var c=a;return e(b,function(a){return 0>--c||b(a)||!c})}},takeWhile:function(a){return function(b){return e(b,function(c){return!a(c)||b(c)})}},drop:function(a){return function(b){var c=
a;return e(b,function(a){return 0>--c&&b(a)})}},dropWhile:function(a){return function(b){var c=a;return e(b,function(a){return!c||!c(a)&&(c=0,b(a))})}},mapcat:function(a){return k(r(a),t())},cat:t,wait:function(){return function(a){var b=1,c=u(!0),d=function(b){return a(b)};d.b=function(){d.d(-1);return c};d.d=function(d){(b+=d)||c([a.b()],!0)};return d}},to:function(a){return function(){var b;b=Array.isArray(a)?m:"object"==typeof a?y:m;return b(null,a)}},toArray:function(){return m}},g=n;h(v,function(a){var b=
a[1];g[a[0]]=function(){var a=b.apply(null,arguments),d=k(this,a);h(v,function(a){d[a[0]]=g[a[0]]});return d}});l({pipe:function(a,b,c){return p(a,b(null,c))},compose:k,reducep:function(a){return function(b){return e(b,function(c){a(c);return b(a.b())})}},reduce:p,process:function(a){var b=!1;return function(c){return b||(b=a(c))}},delay:function(a,b){var c=u();setTimeout(function(){c([b],!0)},a);return c}},g);return g});
