define(function(){function n(a){a=a||[];return d({b:function(){return a}},function(b){a.push(b)})}function z(a){a=a||{};return d({b:function(){return a}},function(b){return p(b,a)})}function q(a){return a[l]?a[l].call(a):Array.isArray(a)?{some:function(b){a.some(b);b.b&&b.b(!0)}}:a}function r(a,b){return Object.keys(a).some(function(c){return b([c,a[c]])})}function p(a,b){Array.isArray(a)?b[a[0]]=a[1]:r(a,function(a){return p(a,b)})}function t(a,b){var c=q(a);if(c.some)c.some(b);else{for(var e,f;e=
c.next(),!f&&!e.done;)f=b(e.value);b.b&&b.b(!0)}}function d(a,b){a.b&&(b.b=a.b);return b}function u(a){var b=1,c=!0;return d({b:function(e){!0!==e&&(c=e);if(!--b)return a.b&&a.b(c)}},function(){++b;return d({b:function(e){!0!==e&&(c=e);if(!--b)return a.b&&a.b(c)}},function(b){return a(b)})})}function v(a){function b(){setTimeout(function(){c.r(1)||b()},a)}var c=k();b();return c}function w(a,b){var c=k();setTimeout(function(){c.r(b);c.r.b(!0)},a);return c}function k(a){var b=[],c,e,f=Object.create(g);
((f.c=f).r=function(a){e=a;b=b.filter(function(b){return!b(a)||(b.b&&b.b(!0),!1)});return!b.length&&!f.some}).b=function(a){c=a;b=b.filter(function(a){return a.b&&a.b(c),!1})};f.some=function(a){c?a.b&&a.b(c):void 0!=e&&a(e)||b.push(a)};f.cur=function(){return e};f.t=k;return f}function A(a,b){return a+b}function x(a,b){r(b,function(b){b=b[0];var e=a[b];h[b]=a[b]=function(){var b=e.apply(0,arguments),c=Object.create(a),d=this.f;c.f=d?function(a){return d(b(a))}:b;c.c=this.c;return c}})}var l=Symbol?
Symbol.iterator:"@@iterator",m=performance&&performance.now?performance:Date,g={map:function(a){return function(b){return d(b,function(c){return b(a(c))})}},filter:function(a){return function(b){return d(b,function(c){return a(c)&&b(c)})}},take:function(a){return function(b){var c=a;return d(b,function(a){return 0>--c||b(a)||!c})}},takeWhile:function(a){return function(b){return d(b,function(c){return!a(c)||b(c)})}},drop:function(a){return function(b){var c=a;return d(b,function(a){return 0>--c&&
b(a)})}},dropWhile:function(a){return function(b){var c=a;return d(b,function(a){return!(c&&c(a))&&(c=b(a))})}},cat:function(a){return function(b){var c=u(b);a&&(c=a.f(c));return d(c,function(a){t(a,c())})}},match:function(a){return function(b){return d(b,function(c){var e;a.some(function(a){a=a(c);return void 0!==a&&(e=b(a),!0)});return e})}},err:function(a){return function(b){return d({b:function(c){!0!==c&&a(c);return b.b&&b.b(!0)}},function(a){return b(a)})}},done:function(a){return function(b){return d({b:function(c){c=
b.b(c);a(c);a.b&&a.b(!0);return c}},function(a){return b(a)})}},reducep:function(a){return function(b){return d(b,function(c){a(c);return b(a.b(!0))})}},around:function(a){return function(b){return d(b,function(c){return a(function(){return b(c)})})}},groupBy:function(a){return function(){var b={},c=function(c){var d=a(c);(b[d]=b[d]||[]).push(c)};c.b=function(){return b};return c}},some:function(a){return function(){var b,c=function(c){return b=!a||a(c)};c.b=function(){return b};return c}},first:function(a){return function(){var b,
c=function(c){if(!a||a(c))return b=c,!0};c.b=function(){return b};return c}},sample:function(a){return function(b){var c;v(a).some(function(){return b(c)});return d(b,function(a){c=a})}},delay:function(a){return function(b){return d(b,function(c){w(a).some(function(){return b(c)})})}},timegaps:function(){return function(a){var b=m.now();return d(a,function(c){var e=m.now(),d=e-b;b=e;return a({v:c,gap:d})})}},timestamp:function(){return function(a){return d(a,function(b){return a({v:b,t:m.now()})})}},
comp:function(a){return a.f}},y={latest:function(){return function(a){var b=0;return d(a,function(){var c=a(),e=++b;return d(c,function(a){return b^e||c(a)})})}},ordered:function(){return function(a){var b=0,c=[],e=0;return d(a,function(){var f=a(),g=b++,h=[];return d({b:function(a){for(c[g]=function(){h.some(f);f.b();c[g]=null};c[e];)c[e++]()}},function(a){h.push(a);if(g==e)return a=h.some(f),h=[],a})})}},comp:function(a){return a.f}},h=function(a){var b=Object.create(g);b.c=a;return b};h.every=
v;h.after=w;h.sig=k;h.range=function(a,b){void 0===b&&(b=a,a=0);var c={};c[l]=function(){var c=a;return{next:function(){return c<b?{value:c++}:{done:!0}}}};return c};x(g,g);x(y,y);g.to=function(a){a=this.f(Array.isArray(a)?n(a):a);return this.c?(a=u(a),t(this.c,a()),a.b&&a.b(!0)):a};g.sig=function(){var a=k();this.to(a.r);return a};g.toObj=function(a){return this.to(z(a))};g.fold=function(a){return function(b){var c=function(c){return b=a(b,c)};c.b=function(){return b};return c}};g.mapcat=function(a,
b){return this.map(a).cat(b)};g.sum=function(){return this.fold(A,0)};g.lazy=function(){var a=q(this.c);if(!this.f)return a;var b=[],c=0,e=this.f(n(b)),f=d(e,{next:function(){for(;c===b.length;){b.length=c=0;var d=a.next();if(d.done)return{done:!0};e(d.value)}return{value:b[c++]}}});f[l]=function(){return f};return f};return h});
